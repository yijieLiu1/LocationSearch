package org.location;

import com.sun.net.httpserver.HttpServer;

import org.location.handler.*;
import org.location.utils.Sender;

import java.io.IOException;
import java.math.BigInteger;
import java.net.InetSocketAddress;

public class Main {
        private static void server(DataGenerator dataGenerator) throws IOException {
                // 监听端口
                int port = 36789;

                // 创建 HttpServer 实例，监听指定端口
                HttpServer server = HttpServer.create(new InetSocketAddress("0.0.0.0", port), 0);

                // 创建上下文路径对应的处理程序
                server.createContext("/get/treeHeight", new TreeHeightHandler(dataGenerator));
                server.createContext("/get/LocationNum", new LocationNumHandler(dataGenerator));
                server.createContext("/get/plaintextPointInfo", new PlaintextPointInfoHandler(dataGenerator));
                server.createContext("/get/ciphertextPointInfo", new CiphertextPointInfoHandler(dataGenerator));
                server.createContext("/get/sendData", new SendDataHandler(dataGenerator));

                // 启动服务器
                server.start();

                System.out.println("Server is running on port " + port);
        }

        public static void main(String[] args) throws IOException {
                /*
                 * 初始化同态加密算法参数
                 * 1024为p的比特长度
                 * 40为明文空间的比特长度范围
                 * 450为l的比特长度及一些随机数的比特长度
                 * 80为公钥加密时所用到的随机数的比特长度
                 * 33代表q的比特长度为p的约33倍
                 */
                SHE she = new SHE(1024, 40, 450, 80, 33);

                BigInteger p = new BigInteger(
                                "176782834455017466023054914220433169531841600192600568051817311812940889334972626974489797462791286114642019856100474509139954246584694946243677666718168113072993876335387133991062394399249371913007566124048035745843009717960009005121876271593681258619382523923571102125397842213053672376457600056145525763843");
                BigInteger q = new BigInteger(
                                "55038731487213882098550081102987418929280550292214990857901282671930897029697980410202204806181506156182779815933606734174934604144529595112056289674075481307656133833463168911231970710037883756220912550504502999012428983559842596163362272763951124690778074093360962814965004844468378359820408530684277519650005399917748578648472383110111261711086932229467383351418942731170724301958587877624755088148124404259644265382792342618386227030243196973786052583157497939879957419888590416441662893129765991722197589391847913711994734052673935713831948677169780466150671822391890362536528669139366973239314120472216577136909616465179866437580889001911159082714187448080387516464042063801876778043240145708846646869395806230092562336822483874212385735082253810420128202035766904141259861021677667379442233670992409724922097835339196466851546750483455274762614066649659947465490868095371323974840313973240838851035767090252618712379218535764588476464139568358784581998956924946140312103549132028553228560541797371764700488070199916408919265774083868921963395325319741716276216756942790715519041765556976308585867690156939094647207245988793068753557903069441325257050906413841359926752893859898792593298632977999941323882966534602009774460031940242559924194903709190030372790846960853593043920043511623637308012893862675742274971157576018704030507246090253893788118704240788165213365367139351111403014432125256492730288717610252182648661080308962263539721361668755949731244093475828191164693923376056235863758308815038953304458666459601946343681966546967563049440575442465865218549526362163891960545774751509602592103315587009305998524858395032956006785039902188089558888162730145214369240990812367823742285961483148116983430308492291090666421808814895245135071488353364953826916702343739474034104617623371026919330987476255207977883136656239518056417467771937954714480893537497418491872231084893427708918565153615257227542493813336011919167001386202884398885304881283768047796959825083697447534461138093467101640426752113255909115022249675910154147609582370202401245926125201236739168042044534298643573593430984928320314114647852030521588244147052128752440322070512445715043597789738927786276736724850299470444146341215364472923116291572619487993826502586866385932120849773130557983992278374241904624475619855257807059619865772423987049277739603158222465478972705858489625178541886926517848665257024596113330715612728424205734214199374818075284334880156193271457208060769356293437265653025242931017697641742810920970320903922171510739559448740915287248327701792475999509437320410297941709175308860499798624048088685658666308528430723028919260631809111883315660179911987750789457597357767109331424697564241269193700092896689263155979075341828359064531013904329591720799843875246273030505631687110447778067586710713531040193804150247956257870270469227526526556898279277686525517308073138720717254816055837777079624427097748034894593234698515905205423770155841497055344293843251388115708958391337521799675055862885637477973660468865743519279768997838947525904764451482627719824324140897853312378662719063813879329825919285647484179147686666052239431760617512805276159814225048465535087964406605597136303965123806088645701490819569912703025192985094018529945223707529122527248259868279491363632393815554979864304843482554721854830920458887687650082426199614940198921841282197751403002419610717842651074360886873941833628319604584285545843231251906813338172537387473679662738533493697232343295154294613053632021054228876665863784563470068180156999459619910059942841807018470772316115145758365130861259847318940346886757889614352949481278692368690285469304591839729287395272068957824799448936718228788646081709038443781287265625042537506169518844646995417745355863258343722084181663932887413268171409329896545710783259548663365138766586497648348241430391386462424671380058264741429665991255338314980417977869628637957249045419618183437434697313916927018068945520538124546762737117250887598121558827237369846323156708513282735597393427702061723572981451018858844412554068355908698931856256384330848327681752126161135165383091556902681765508691863575202491181578177487869606141765806225504416670603143144979569772573416945292907232003712065672700449682391157255178581445946563788465373245032196175806366065956084181233237335551971121314306496766556622934553423382829080819723882034491317750029876294744025609474824827436155680536821009434323466328845892751381992937844466683531649887876428506931787309427016434524407104956203708114545460495640102501163336754382657902155982927564210423822121357104258107534967335911593803667402567586202424705917688838270598193375646497728068716093769356937110515584076571417821204582351124090552992550435622622938970658000001585339097395297864002305191936710151391959906370043351186414553099992342943525505406987173712164939767419506765585649232768152266686150485401325970216325458427662562108793150909293639325148544547619583584397445468503349424844954422522883033423978272567961250423974285237274498316724736102603411235927867894825671910550047813113921849143472378200862951100717337336627590341617536749075851918739342006620063766027414449615417553582216157830858153981730681272324661542643040555914715299530932478090388011871760996858722751797398830322300554582242759425335692706140531202245312333144135046616087343511392909101925261536844459389604159963209165799512966765962164904306226727279930966520270149346395004568959379231139648266170243817547678862504734009394486810977676058418388895502831377339312177194860543507105761943035882367967954640293011034876151182838132389374883679443215746142498332678611848319791611585547322779139988119721691573209684936858801819060958765530802265390898987905252854714020447448737058549337810989266514611079547982119523480044615376716705915551234429588797397382685480061391277517364658762169741092323515798502278883510615598986355131079715077229275457149648608184979429475098098893259997984379468714193511746342526196844104034473128427280193070469956732857866533285718588847363499774637658922858030194702844792763505435818402082153063544760649781956588926219232741488580609694331640633716761042544391945206013989336623143034980178924861796044962956640558977081460673715543485351860806009073077493395906101634529712366520127616986397912590289819379541428705287407090741913852300313428005787561869770406073846993226105008993654912970296634686670574171169001753592382629451149763896406443420999727325033726357210050503668348919165221246152750836547795084244612127593922301059537153101628734377807961169369602338656498771242085439215858672862102923465478940235743731293069206524362248114504819310178981783957740549496000602512309875502511348675871606887066688151974838061041512120521757058685713206877513511360219730782606063883496627577019756923476781233655875803457941932614589635985618458790263283499041330605479044677435028495656894815413546653068817374838895941518390580832973545769441977474706980704141086639034114430151105866396081680247718964799389564241001523215810272929082223679721275891298813596393508821578472179311846371167061606427695729444710185438830108607435508848367602425625085343046706682033223303191319234936134035569781372152452999810085565355148488478534417710997706157368528788778608500042243936160518996089040218443447123914869849191877101636518112080688813494966951141500897815593452984903648120293012518673694324555478863951168898606234032203218666597758584451599830349938732087056484634209365031725164747109012645704382472891518715130785913026124327786436824619608577067190114512990561333393829554553093538899404742095193940243208268554173995191687895531111379915856099995635414658157847717571297129524598420682958298776215436349947438517037990265254712624505102433935167611002476021430773945886420450859315806909802155153452696528522675036508390702379483392549623520851443969064306262917903502327659478351827597091705037558851872820807848000067214386930545422387444718984662925061115014572057597185363020380695009394545639718611818435394486615150656785844123470488499843926227557202306110737924436694815292270928006853409335674620247971657675569928483855503744515434523393205007971524909785793699550928771788487056613562208748185698565880277095974048135694981283181076742438996990060356608618979834517246177389680408735134604338208143963626158810327353158402161475218576135112433484536571808411303804069298292044225907101564374032100621247578389878891228963947503601935900363902528634653857525840802035851564099407406282621868996470122233892766479012859376038523327023811497037108947467465197813080073701295259560693456331411209250983020125375169932521089572365919807534701576558580727020634929941348618885631769407329732188437828725663686259088666437022278537646526340906888927881540251865574022155393492650671127965557519202775101888078473855547943095900069716003595187453102545573255413695551100214578166247748930818123088336791744541476705913828890270584527795499346069421170998793529093142026410327250648630670769727467438344233909337248128279804103235406796604928015728433780484837411074519531001798174997417795041037620911382322557866846285979497589512296119953367970774569351421632550728260248930341976334465142247569389914550288799168238271168867080138652867844485030999299507268660177791180368962354691868763285802756859849747728607995600261630553113984377730119198746763271064362871083644587163624191619804428841636909379205360019113038560218990927868442119325836085172273585911891725922404808971002394267116304119386134854683296961745815504249353173052237046446433626582392565586368703532042120677301816255940610854737933074361156815745493360101925189796226281687448941977177064636688570641986234508326210240097387528222278106754639993011016625182488315350726483163940230014644522760498558646372844841559129533454677873843348481397567066610616563356872568363045493975626362070186158533596846603576550673669773980371566201366481602211341986302001457747466053613112487122150909567442443943676790234988575620362618338707613390248925142799255086979127059832075785477669706871963963048182603124080071445733047490476115938741207965969092324736373364245228229048465014951187186503");
                BigInteger N = new BigInteger(
                                "9729902957118288975958935894060152142366019335847829734221242355796094858723038209622682111659087589831110529145972377788721602257283360508016162266485082762316606501120307401132336428668085666366553025450103404594047484153891584422477755349107553454162320813640099783914352805434347895425635926343294014333558054907864160381731381523381008057453901323402074623887029160290148135654302680692372473773310963755248038964630260676902965615879355289135416355460569054759865541057812898666445898570265282461682839101558944552452771446984021167133834287021617468557420664207095322976048207546523233858412490161109182382778059081173754402835653887461301337795264807059482776642418048255511624007448908256435215284689226188478924735624491245245863488208665309937319612867641780625665689796377914862746115502062640648226333636226146288749311706775265035778077860550600044633378867518366263018769664445786604434298333410717715038778434484375461613220558432960085599403496864538284744009935465358960187869591937447334238521471077011363927215519558118965374830756375635525499813632592416989438024002765578945809800625349322090313646249742807500172855335254844646794822814191883417656109062972196820443674451487372007263607509809768547087868602945322262856508666839160069435969952709841487069560159585206269770064226836221717729646136733260630936949955258983065555732102618577620322372467293139389045614951494277365212501906379669240930862324958397716711028645084402638658975254907565077090770283921671161525046956238031407882812067304240875345355889442844021004047382612014847994243620916970159811082212304621667106134218934979695870156227211903055247798049876481577908447850215086792029083816071151400331140981599082000686072558024083934905744946112792801693254699215631339142343517801571360214555092335130812296415884933053432284839914849482681244031831388257474107812232662964883882674907139136961487249699637755741035995453684915694693312565557046769458457413377229108405821870175315808103302549605131495105360147319763807611771774501192425103302990852266453989592062751234009661239051246797544483692752234136195761032942120655729777531216671338423431674657879559769435521436120449310668756937975985084245729681830005692934656864460100478665979163189506460800852571225919293000788770528053103724236715342633673697226699875877218029585797771143490663980629694295893070398842231706312131057203378524369747637161351913203106142364476974614838942999186537604701229680330385083176665758945292254957710559884681825258040979432350903940615933617218663928917752683211306265476836040221215209533873318397853516446610910118463891321358976569392918220788106217606607279306331854668021998091254453758658311281513060262090700439187089321561340801266723675312581791136086536679192963854341025661884077566640064574674225896943857579444921028203410930753858321103249230859817590505632850399827088984153083589002045862496352659205776192765020172883088211464994263890225710698952693326919912071418855732743049655699243620784192055305456732728644822083602267533496170432661567578155401890839796894207160557714236819029927309472842810705016998911971653404453615045771366628811930675068702123060119134242136512911289432998120866610985648899134728839666078401373871351490491130522405026252382708844128165117964458657131645269244873853427960616507048522969963543110580432338409853661229144044511876580543749136529863766047476156708253189936701829571369199999339012308407763439618175445713736339616362550058418072948352546425814742621559534794143177143936203387358978491414461995397216907831380604298687229291703835449542788461806276995285760769293058539382475724861237019864747024046256966875537149537067743109499981344107402391987974296849051190577644969153931130767462316580906546568002216580122411239811200751461296626794333707298269437054670904354613149771081769573458943666891772580191984360035548174472272453886898401573360849904754740745209030553198738020394027131026218762538928689726190068089370709987542548932296100890263850088134003215285905702524603048747032931012262646116150644342009343919103198974216486996348178026818602434445005381681483100898902460878542101486278734039296696122414681845614524826601241214130984674009260537361283565647561206086329689905201948667563704210587622467089783725762342136448742974728350354454968199333914791958922969509593243833720530186865526316872358778997540651698216291859678040737904351208749138101421591201437280307111516912723291852140392315251694669337753853879748607549935827045402193339637774302987275576326332556897262057885968997002404490904746774818623250035096855823199595930156172187318351927279264273974405171732702568212687800443662946329953338217528891558621949024717237866651274931971713174016747184053745455960320347685821328258399649404966762119882054208792475524697077036027159319778924125578791338199097495455479005922297286171636752589571060018586100732906135440180273244891535200695694647346781199351788799611977762199398461752668770983996670659629653075016549953788069658623239033543488744343057788138939455069165151343872037981094360506520631658473680692226375429827993744688193335657561844475950640086024166665933554099870853991619700197077933050262025476155919944121503305823567174286179459090065588467543372355916812914873018264943247470986825096836424924264666903323289898745334670519998440159172599474366881242767429726879123173422008920991515550318782689953398592378953573469992535549274218790046955141616457022423095999095029095696690894193223670372516408122202939019197728196841790514687360767767879891507129522265281113862533411376842572241481869111327001523872422954855303323995191182931620600356330016414788647519993477311139055785464790044636299143396981359831468431056425788948601817343729635120161204283888070842150917891672186742588911712024948177682098822419753751237260873694785909554291266731313207065858037435562145696576833672815738040773140832094904871366817006040676452990229370565930653631578813941800686374265872003524150857365074866272937246126715233959009864979622618338352581818119291005606283339835271756386949349558571127258793034856447024685132525744503106910620072425552145493235831536154046503504975409665944323394637762079160291386819589520955545492769006016942853422456484834644784684236404679559027499238558016086781220929217015973624363051932955377425132352888653621147879392030259901889086127232010639393270125306517105206905666096372757948833701027508601311875251470997608071920754998613833846653617591717564076731692306292070302706573425832289966736788215999087910336154669029426654608512955262012047997550620475381894420792661125038884654035886238485876944429492535491670068431885571679555676349120919484344085695983863830132854966779619805087099194645553619483935916305628419332368263598958925701455915545670246940904190252677715756799873252586823337194546505417593517090371895634170744459026235063284684878435759409807794692677133661586871214794738734319566238926386220281678159012538824397688507322111120770484109948205022172686473763262222123392754844597107781257831454781636478040628995040001123279443373833547839525814528381164404920074830934479798532206139092453107536021263952731009013783456511908693329964875670329127076133537875110329793824842210096367140724572708215869543396221388161463078791564808934159424875750987032225524218708670853957299668628999650903486374391559077172792601046234463555969196748053857933746695500838133584812747312507570414106166801240729457170456868741533630364659522202109949949851019055658770012117953273684558384161266870050087597742919786599758819836095134937337190957990828636356417443665149133255391673990005846921430915105434388926716409223567638851793678364705078711393721263624971737910939156063046832987983186612721540989971806010537964822486957468721143593080081879946545197121719364294342184983193112276954078291609018625502728763297949243494313678968490285398753720052403607516794233632873693680757368366717544502760101038727931323451104310771437407513549977400916425133010270901365241789596962739828454923685338158153510272487732257846941339579534994754080520710173510652243917623747160043757376363326628733233430889221686556611614017984169679222215626018037121547127382761739399394271040823842210214462253271304035867212685063093378736314574966935953032691494130996696199139164761418618179484098990989007310478493695062465604899531331781396922258194721842183825337529437874018616658017517984884179239988346031227562301752364020530121509971908931574489103375346174723719872975743269051668021600632860248088045321427180390400648752275740966195230200022855644947397196333397769095292348783858232601705338057136417171814141874969659369540819180735132363845372063064401328073239105466286329748754508893717433073869500641747394950559483842664274272843272347073038141742411356183335952281504747212865200567187262007942740037859798483709969804551201384443374388143535381878152358827572401322785731094767571084958289648012403268239540227788256440199774904767050600975246984165812459006123296733727586261719336409580365252639129831282599858234155131931952430480408449540323516221343851797601073218552413731118607550594164586451158390288983955347867907414879270183678072021471847658108263955813622925467712593799323980411042171748624139597145890079757435012606490254336191056691304386133520098604908474064853033683837669062438355625022525886030448250618627366033194399565301436236494772608648827288366622698394739365256041071141234746046950356482892453170836021967771454816097091903624472448466455445910449243557751627942016559650511448588655309524423911632062051094287150361987693065479398650782186969493097904194765132464646490267902019051203920212238792052485359310361305938412178254948050204829122655588219838434707480053922212355864586364554927948411439507199320972240921244672877762076930553053085268435377119887553161890579511943121491150755078485512658114762358877511758959366563121164557895612711581361380493747924845192757049142500961503624108049780789124331654111271168225487396548060112657080127700793625071544254012713969214901828032458685197349771173289590492612146736209218095316774554560182376205488993160158734605245200241251339588528360929326031138396606013361425354597158625899584725773955652564194984786872671548596964214209981819262278569414034894550014395084403423576769407907355519887102729974759023243367032982547926426545573024502775849609409329852381824564764424659261526105810183272370525418687912215219267305689174843523175011029");
                BigInteger l = new BigInteger(
                                "2507453097666707339087527400535760989844068445226749789860874717229693957510601936187618777112232653708497449405478263600919407131833943");
                BigInteger E0_1 = new BigInteger(
                                "6197201508212826747755154812780969473968946894047525961265457298275806831585340911824288620663818596276304935303505845643922018627266067834506291775414377997534867385532043420794282000210926545040754298935843079355371142030035207988574237603687333335053345032070202797179147116940081607021953271649431107737375663992150219684197942061873934730954693448681712052231275683592352875355961976906768136363043245416580524599506365036767476513210373309990046323288522039916013966451052189927427546873253036378670196287637782584930118860715872807326485781588343254950559502744390438477081902296721132429873283262121142145091026984340833528406463726948857669815039710639170283748621281366595466372462969384896708778237831692371710863237994946100352335008945408452382668575520977132581321385412566288939790484418731864689974793170298934520155960819361614572897900337803735052260620858867150425160148161717178652896096237706516648725344444938733447008754645402137836300392515023467006056864897678649486143495159941267249890464344428421357611253463550325291856692461100420679956876236327652171256935642642109932727548081371203688785216523133891634834183187800264458204803756445583327885383028590702022286567668188275334408346084865121972304373071747949046145901959524696068734579519694848593068526497265472157110295747464846179048051002376680640768386227880729178607304504092109240401082725949598149380626377508927048621135389505289429459917339030046177911693990548081482059288820603211256943013134056063215400855355121598429068423288107838001676530861207963540002388385633234400283882551454224564745385962341829328983873272874753081674060077170488069884123337636392813567201485362597450689892331472211393840442271076735720591629654285247317880709072301181871537529454609987625061602889039851224664232507040798520833222521625011791900223660418175283359259973659847095704134833315469018717949798640838016516053266719877693413849582845325566971885233794796900248861677218545358471858475691419859448208798055296272871503278980760839306864801080831311411015239952742038197051172159780642193411926233949502106229021474550161702572235974284404661427443285654351936264590416519512987799147068445268521368928761316694452810223721543955341000213374312695959026492701161071396957764074506778584080921239045202971001698924301439746829943540680960665290029378943878769842172392147169691578962148464227449947534295516917772132502416124995022783990430012619019912790892069627723604821654794588925117342684708392627267316362118697277081212235605112833205817895797826890642935873924121005261048730256991951310480964139538387135998969402143869786952811934528938450132158182738462564472083276537018440250620392221696936401722080768618270642602917390370177816541180580706473211766915092319354449330349293920769811134041186488835353411779661850392696957956654854018584754910719192758962416464273092247482858357048763530011226318177802905907805941701849578833185316374690253343580352195672083031116195377597871639339469985888027482304311505184819908491714584365451911050059952540787881813890378103792546667052207517304383730758114019238410854013729581644110858332491990151201277314593526762472959426926365981299592977428926274883116469807719436512076190078988153460684217627368315246764806514566586252721393026542761059802504728705600240752040937598174292688228111290932548137451160072719971997832547070278107742322839404742335948794789704214838409071170519912027875112078181577489031750445069451922412440839294716629698359705499410850081550207927338541484403756086790641712380757705170129946163421900263957551676982180186031776402831616256860589869846649341040548299589186852693069329451467878682564617461934012053105250323057683225647694370703781084257955762217936873273860582948478842632319242063118379117343754448787413473033637624146851633649795881814707487095059180560557287711674750702742550641497844592710497852316524214505291618536974658925028512815276375543735615967457733353022235021682934699342724528488506924734115874851620400640798988817895720890559906403881011904024687876102177626144610216386274086279123533724058197633768836692934676377193022402698801027397636820178556699510800250813778195977990792513251135587538294137000963416685238436746250859480296926776711351963204379153482960800868432656103583223491110914806296680060209681737693641466028400806175662297956488612417387855767452011236075510793134291304420245747161944868267843196628664667835863809368555028306792993036714324595435639028667649517131437353978059917831114468965965067413634978033304541659930413325683415527651139813510977160251683988837602811254427679994114627962515978079645580960214021167937333414209675883735385307282026126574861804911510946796686901390244325655543385421218239795464625663993139747281484611973709840317445586327005297982401793733363325228413284690868042788327093839943665937178700958383602882430190302056268180162579611456312190692014605809056371444680718692688594868768353450396723359089519296706237244175405643464785932750153328073322522935473620283768043387576210743713811387956852091995975531164854388461517738636414799020576492940449393097183085249200779084159012754588795280007152902689436877174637038186643701002692066500236626266763895021260746771700997200799796649648901943100728617419021246106893952153855717606390414067341546901928072869467492915692033242464025459694217351341267682147751271203416273058383678622887056615751086712834794909614385903205549168477314245701812149441515131615563743054026515168434626028392448662614715534764393398022758533599327653070347470172394809421359521652175969568805086070468132331960730980946481212108685095495401543777115150964432764564002775066686375559810526733192979041174073161758200666805474982593661752029713007706276122590166593267863054394769319780432541344418173448881227085955315764261983183901321804921779036945674103529706342906607764269464990883892018747745046708756110438640994554298155680873782712893346796203147724489065864692077894278201726839746054726696941047438094950150563885088848540893507617056156135553022010718771204847061001300853033564921941549905906648456445229036474070838916191557773152836881168909557574506166688455793576729404768548266897450223402562063337379349134278463725042898384047939869053668099823829791550101689022927043081655646589897206995389135219565686178870210754643902758756525070513525924070208295858004496180427175314614921280291097261418012725113810066066799172383391975735824335898968113861569958531945520941959358602866961564642562944396926002237125700347097725859909853231250016660248859192471245181259505125647225678877024609103752046135917726724168431869022151095829481056582723804530274995535047059179717278501414686678883717891604439778008131577141862626800402658343716215935368643238639133482603335811056752353025199268086281487171990186689561237657846981061403151817874845102726427411440991275531388913008015853292543964358114647790316772767741648721387311391435804118950137991188292457929225258003141887661105904166658305743545548972579486889858862199109168231501370648930307715259196639160973783082363559508791214060973073104309673084090196882906193204987240967698390364769240689383691990981839707569949601694471093342389025310840190335243851864854543639364321842012084589204451632972141632533834528422791855252516796779941230110005288077390054212892506691845570803911310711342530604348079750043635084757256292953040369608019286264906466511554833997429660694445175700879754670127417171867991838797746093345024541926578278627494078977048256312082499220048226118714932267604874550992469751596154515708744005818902457231438290074835555170024326404204813138225328625854382041038354557524654445350215015400940845131383460262057021933146624066080870222666426078156459168296626771477446809140875625817593481738810870840505558590259651001714972201742925105306198666939587965775547534097987238296275384530393959977776990094610216108047198155913598339369820045316398365592672124665364724167315926077946898774854303051442844436827075811467960219805384623374226167734234649914954903908007590353569035838129476898987586715692667031657777082636723661878099147823183320336875330887277605500069712547030537014774995480655302716458575564852312709681513298939461146760431347455992859185232928704283504349121702141701010770205385703850291602169498772352709747072740694487335391255696351860786687091128528081322986564219844486767066177017487940748182008160508251876032088452150850153861314732043397786010489736253112582615427550987881037073052868515671580846020253622209542572660032981883162891189228675341526417035155520593094663873948187714131754501293564857001364136320195875903926253176319571991292096226034850773537895871339211019201550783117455591565832098223828474939579251592450359428913500848082551713888761079953572854624104863162033956903860995937377296307130503303920425171311284920507369493484517358740418785077252535321188575733653953651103307720126347929846578284292996840030604298981180608437645412733418108020434193165529971873238335467268840773767012936232602776379066760624077480197386045345691560877651613217079350363853364726879264746065069975326379473799159730762715508375448145179253191041995664630449629418201411910486913041202770692263381442699599222944076537241076765260385440214240551068852094014425613079135671089673904455388249998526305319354372320020386275384111192955976764439975981426221422302718483875587753147171328853369597142968790690642966383838359472347992687443962540640129855581623356049603242242246351194209735997092403779804887628422081715282318783259887994330704447182934172805310346868965616940655771415699593592639121111764687991566331363503349098091153180784264163601883599132582668292544811066996753069944850464273097131933271164937037247785258779633386245099612152048763695534962949771664730151232865858026861791274240960345860745569878585193581394774874500033725734558563738280526918441065210426662834031008415055109625863397325235435361562085199152326199008349493139844596708901924069751628305416760458302844496305206715548838383128207280721593956668294820120259992908146926088822551967196946785743023492935068725235092451171962765189990028126424049384804645282792682378540466768696796264923719060648060702634012249001676526352983950044793535947839703008511777419884390122456907329325855157240447509006595335994790261381873641312589367362456547715812574172449649330977872074226336335966006191188056224757414086369705321060937497058210277954776702184385723125391166748");
                BigInteger E0_2 = new BigInteger(
                                "1666315249358469829629990560691186819902444276394481750188214990125849305955160268477953708553461021782746876039991168939657028893132570910681354105751732587779020015395488184130598936787251612664046064274817182658765412782683540162276201149386718446602104036048488855370483909166624711652337399418539573147376056711087071687121930754800270553351771741670031128249093174214322711224708887111628874828940756950828123417884009729778551484239587279563791371425745630240503881079514794723792470776998084348810230144415408203903372462126742758343905375274803109639899785139368066927804430279042733357550142660682608983058898930438855492487526546487170787418055966808173772184469402977126380856595901179920086479500123808181247930630836601981864000087809936325589151736225925716614738323613952068382656509009213903002990935151057620934698555423600962267354817068230806533504601247665301410164778751631608593651469473409794482883101091512687133361130103810814512809522447987549901020966598267536872443467212530537777460997986572855173861902933729836299755613175081022406417822204751685934329833309232773883389190793749583135792311564145439606797619256838938272270291827080259811880971337653051554012511509915470187201503064896147332524441285518688602609542077040433857406646863584797313678230071204858310161934022929841081212166089304070881478772766043464817552065698302264226546498871713830338198582649064964417570188437917018199237466666597583819005142961162377049857299692834088769241148814470245147256193055915004591336321493603939460824302429088179150556430978366345696240627568544443522158701565435971961252088098997810713537943494616380399514126441142678676774383742985619032093887927688183788238855446175552815274729653012544473798246234404115519945678435488689794865029285451959001719608677209554267682048904837417399016440068662600590990471575833671775122425846650813939997635200666575368247696750741675742723284486417591957911273033507973702606753840902189803531440302779357113480349927860248596694453164825955381265351836060462664677981821130210078340500131832499687442180534721917343627931336711640055736369290919081286008432677736521154020992607516863923219186939997441006975526771083347792437441590335053751899822934160638173555173637799476828219842113503486907594454101022971653133918389987572356921185040521263442298809356885598995485414186947540540108020343919522099909894209050181460103413191935051779718698977350277880744940750810133199384287187834895535882833459156388671031423932025415402384097321411655385021217892038767730304569974531397269912828592680226171159391974070335086023842660463340101746427966728772154920673087025810217713126022364057570767158474528057876658707834645364663240285835445198808010782642740223989839716161201956757245326491660358486339406478685312986524090285331180747327935248759855245318555326732129197063382792981806512072687083663393659767155606713261633078085809510084628551743817791645389487044101146787355664589656794317718967835749303685937484794979634179240032507707326804524758412847280653300960964430944758280447580478000349410030895783300019504225982712019146364074490434077057559296044948586211513576012386990671987069430136576368597388233007684474112475526840985260866454744182274574390447891253357999621508721759048549681732884197730236972428390365760081489061842614716074513801659533582159052354814039285760322848721944483975617963805488092970281805343539524936000026117335226758543372307798632850544588343963390640326791919721494441591605194550104479903898930633767831981834811211131866815023324426479661968455683375928099349515297503317702987588482369931572318221618009839283684785883687037755083514342977056757440819386342371188420987565870742613046280282961658874362169029191815227195734941223080456087033987137720476653103418438800494324270812143763272992872745970446286630675067056161747200041582208628032688493074404930519235589558481666527115295272672793211306870280793636091879253882220755874044725744592311455204841636333126638982966452433664211884855000129581446507630922651619025306714413955388775536143289328374664604026979951573112370799618183718036953622532932825719878117289914374145422169972424117238323463770038489460623455184023532075536293945553751416472915692666958780487759468605690776818896371048505014850787750752821276099475340177018899615407385195107847492416929543192536995683093309570565913181039632173051560091409607545721529646968484368203124465143691634193686779116483217442435778610950992127645835722454050290283408732648523842906544606395797546099240613613342841063756776362848723650716089592328742785470905639838390233943094481427544644128625066559954427963246367327662914536540509011459138989852144320878104511545141489419308708358746483660175921722534842282049927016955147706086865624520310967336965812586475789928854130632802656572886383624543419053341926216243163041900770149348754407432758198997990762988850022528987459700961638491678323617573325918961003699083337763839689436761546416709332734561038119408898958386840727297272009374975619428282482077847523136024225672633624828161151738780489701682711414165687407489169761713597775077288897553662665642511920584831176527496406238784281588603070436872205332526029468652687936866570467950660154936630992442066314071283997357986857018447535492883825128236277685443207653435012851998919418572016326952347120317571917532409805897253499882545492641479741305505881805758206359872003610314187491947404159711196202580876533727554017859104181680068815590906850909057860566293610387455746079672124110552458341909452084868003243221327543724558103457676224034925797792867244062386939326163154154620202058078715417496831485870042902884273219999951179159576410684638560975380606104375300903773454658659839378735466029038635995005290821874334959358825693474268363822396592324272175471931380360552866180494447678814783546708675621043931799092736476058043540899854508853128846748144005218799697977828694864886064301362131721063589059473600010293623456600443509869778886882551721869714227050985124793800637707457026281766652099057975819082956425625208376915157316974968492160132906398376298257082754205227939695667387819433786805356351481440937116728703957864636618890996685056364387875939258965061575610752134760684337652117739859763260614659619782649747220951476976084993046708238924269172852533865643885324097291991459531472606708820566177640919413050984585528336391963562585085511821756917922563165054771273635084701487099713190332369281298087052408712121251584264549580326152405035885460156729069847608612472083893483658392396032639056357199090858899236171808552654761001717681422790816632114354215467337779539031552417185719198433840554023472044104593306255486739159701175978502703760551344104430566791004509276244549252796686882419994676177278849163161309739607627624214303663325068735141836698657537057000425828243964660861331026917697830131341850740911970404005088000089469294583193505863459958627462470803214471111523426885398040874120331440633736891254149551471302859411339064999287895432764373117282724786510022763930652023907052603473321604006897680694490935165107437349495168585830045023873443672961104743724283652732638528070351973267517159529560717625389783412586645044369056851852609681075674068579195177478722733076795854652556079103281048496823755631266863117143527900729630274963315540248145721091848328884303698845401115969390564712510565512545312699357214969476222987108373254326787519837277131277136221647414966760758855937241931727486206561274370874670564474468711653277613220505932193466000486800432041257565013077204488089996770560739505132020524163290518101587741353584945051055429010539126026631021737707479762254542312298103832725729680517490155328827743444497851290221227907221315098171889874710200427889573155251843816637819894044116114206111163948428602492866797444284835270355273623194961158843383933386239998009439252558213950198522966680134874976304760888163057023340027503193376071424263444839408708208066380838758688234603083753356295182784468153777866807686698836282659089170533249242522391994744578465829752578993481064558489775040771444491650820851547031004531186882371643085114782103929590919003552509692917738597162075705871346572395284918435353886118898062326294444928552246626559139452232003933681439405017267205116309062135912000300320509019208146715534700664441881418562959761304457796237593954805166805424255755671277585525191658744560922057030656732479490863958413487724166253404443656249980366156345206318294005480745776038887505232343274774273044772710085853983079194699310182294513787243181161358525533763667596949784910529426077439938255578561509217904813793052328553917237195589650422862752796583515676186315167029079655201560250880143031036291829591840587868662230975744295592261529131670062954978636511334365266687786268862954813718151393914164343783659146496490470958985528848722026142327549541984183882538120375951748345756505525107741456884794538716566084407334745740844729449351288273697576516278572509896099462942634677870333652637575826392962321503492065508671333064140219578051509774116775524277920494186677440622169581324293252433877457953416483161533539962039540629364546063689565763807845283795859027902117128097683720879453384780145626567786455104067626910619136028765148904659037600952259788554319679922491734142084322688808681207928186247432493726110769994963082954477972054300791037253956776465298175294436853765893677576110248454068940169294509871719019243585163532441796496833605409009142891147305786849125887227769928584495866015494327868602870130388170628721332754498403400119366843390678996886362459693319748025701871000713754355882899273306444394085546708168692291029218613329590837427047676835448132410565276825332896806920917777331630888449705423812973039854884960884541188751975125627247583716386928551729657739550525090585861320046843176738837457577468756364098990890621413413344951821884207048516302834352987094602085231495561238745466273726616267363136833674431570735580496207067268846009815418108847671247522126034436180071051668121431777980052761593463203165603481610780386564576796708188515674193104235974988810801189982803216937040494154554168995836768706674402465244751860807516651639126965116879415685107655396230370692521369685343739866664317491627276258086583624440109815134025319330746812532512837921075827286806257001797347818463428444436218530547028462790417736983825759139451484952466783277409304966087262138902098423678896084472585316808094973337342303676582");
                she.Init(1024, 40, 450, 80, p, q, l, N, E0_1, E0_2);

                // 发送SHE算法参数
                Sender.sendSHEParameter(she);

                int begin_x = 4243461, begin_y = 4313756; // 测试总范围的左下角点坐标，即四叉树根节点的正方形的左下角点坐标

                // 树的深度是7，相当于2^7*2^7的区域。所以一共有4^7=16384个叶子节点，也就是深度为7的四叉树
                // 根节点区块边长是76800，所以每个叶子节点区块的边长是76800/2^7=600
                // 也就是说，每个叶子节点区块代表600*600的实际地理区域,一共16384个叶子节点区块
                int treeDepth = 7; // 树深度
                int edgeSize = 76800; // 根节点区块边长
                int num = 1000; // 测试要生成的随机位置点的数据量
                // 初始化数据生成器
                DataGenerator dataGenerator = new DataGenerator(begin_x, begin_y, treeDepth, edgeSize, she);

                // 随机生成一些位置点数据

                dataGenerator.generateLocations(num);

                // 启动服务
                server(dataGenerator);

                // // 发送位置点数据
                // dataGenerator.sendLocationData();
        }
}